<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Your Song - Muzimake</title>
    
    <!-- Favicons -->
    <link rel="icon" type="image/png" sizes="32x32" href="media/logo-icon-black.png">
    <link rel="icon" type="image/png" sizes="16x16" href="media/logo-icon-black.png">
    <link rel="apple-touch-icon" sizes="180x180" href="media/logo-icon-white.png">
    <link rel="icon" type="image/png" sizes="192x192" href="media/logo-icon-black.png">
    <link rel="icon" type="image/png" sizes="512x512" href="media/logo-icon-black.png">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'inter': ['Inter', 'sans-serif'],
                    },
                    colors: {
                        'custom-beige': '#f3f1eb',
                        'custom-dark': '#080808',
                        'custom-gray': '#232321',
                        'custom-blue': '#0056fc',
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        .font-inter { font-family: 'Inter', sans-serif; }
        .font-extrabold { font-weight: 800; }
        .font-bold { font-weight: 700; }
        .font-medium { font-weight: 500; }
        .font-semibold { font-weight: 600; }
        
        /* Navigation link colors */
        .nav-link {
            transition: color 0.3s ease-in-out;
        }
        
        /* Mobile menu styles */
        .mobile-menu {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background-color: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            padding: 1rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }
        
        .mobile-menu.open {
            display: block;
        }
        
        .mobile-menu a {
            display: block;
            padding: 0.75rem 0;
            color: #232321;
            text-decoration: none;
            font-weight: 500;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .mobile-menu a:last-child {
            border-bottom: none;
            margin-top: 0.5rem;
        }
        
        /* Burger menu button */
        .burger-menu {
            display: none;
            flex-direction: column;
            cursor: pointer;
            padding: 0.5rem;
        }
        
        .burger-menu span {
            width: 25px;
            height: 3px;
            background-color: #232321;
            margin: 3px 0;
            transition: 0.3s;
            border-radius: 2px;
        }
        
        .burger-menu.open span:nth-child(1) {
            transform: rotate(-45deg) translate(-5px, 6px);
        }
        
        .burger-menu.open span:nth-child(2) {
            opacity: 0;
        }
        
        .burger-menu.open span:nth-child(3) {
            transform: rotate(45deg) translate(-5px, -6px);
        }
        
        @media (max-width: 768px) {
            .burger-menu {
                display: flex;
            }
            
            .nav-links {
                display: none;
            }
        }
        
        /* Hint tooltip styles */
        .hint-container:hover .tooltip {
            opacity: 1 !important;
            visibility: visible !important;
        }
        
        /* Tooltip arrow */
        .tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #080808 transparent transparent transparent;
        }
        
        /* Review carousel animations */
        .review-indicator {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .review-indicator:hover {
            transform: scale(1.1);
        }
        
        .review-slider {
            transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .review-content {
            height: 60px; /* Fixed height to prevent layout shift */
        }
        
        .review-slide {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Button selection styles */
        .option-button {
            transition: all 0.2s ease-in-out;
            background-color: #e1ded6;
            color: #262420;
        }
        
        .option-button.selected {
            background-color: #262420;
            color: white;
        }
        
        .option-button:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        /* Modal styles */
        .modal-overlay {
            backdrop-filter: blur(2px);
            background-color: rgba(0, 0, 0, 0.3);
        }
        
        .modal-content {
            background-color: white;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        /* Button states */
        .next-button-active {
            background-color: #262420;
            color: white;
        }
        
        .next-button-inactive {
            background-color: rgba(38, 36, 32, 0.12);
            color: #232321;
            opacity: 0.38;
        }
    </style>
</head>
<body class="bg-custom-beige font-inter">

    <!-- Navigation -->
    <nav id="navbar" class="fixed top-0 left-0 right-0 bg-white/95 backdrop-blur-md z-50 h-20 shadow-sm">
        <div class="max-w-7xl mx-auto px-8 h-full flex items-center justify-between relative">
            <!-- Logo -->
            <div class="h-12 w-40">
                <a href="index.html">
                    <img id="logo" src="media/logo-horiz-black.png" alt="Muzimake" class="h-full w-full object-contain">
                </a>
            </div>
            
            <!-- Desktop Navigation Links -->
            <div class="nav-links hidden md:flex items-center space-x-8">
                <a href="how-it-works.html" class="text-custom-dark text-base font-medium hover:text-custom-orange transition-colors nav-link">How it works</a>
            </div>
            
            <!-- Mobile Burger Menu -->
            <div class="burger-menu md:hidden" id="burgerMenu">
                <span></span>
                <span></span>
                <span></span>
            </div>
            
            <!-- Mobile Menu -->
            <div class="mobile-menu" id="mobileMenu">
                <a href="how-it-works.html" class="nav-link">How it works</a>
            </div>
        </div>
    </nav>

    <!-- Sticky Progress Indicator -->
    <div class="fixed top-20 left-0 right-0 bg-custom-beige/60 backdrop-blur-sm z-40">
        <div class="max-w-4xl mx-auto px-8 py-4">
            <div class="text-center relative">
                <div class="inline-flex items-center border border-gray-300 rounded-full px-4 py-2 bg-white">
                    <span class="text-custom-dark text-xs font-bold tracking-wider uppercase">Step 1 of 4</span>
                </div>
                <button id="closeBtn" class="absolute right-0 top-0 w-6 h-6">
                    <img src="media/close-button-small.svg" alt="Close" class="w-full h-full">
                </button>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="pt-40 pb-20">
        <div class="max-w-4xl mx-auto px-8">

            <!-- Form Container -->
            <div class="p-8">
                <!-- Header -->
                <div class="text-center mb-12">
                    <h1 class="text-custom-dark text-3xl font-bold leading-tight mb-4">
                        Let's create the perfect<br>
                        song for you!
                    </h1>
                </div>

                <!-- Question 1: What moment are you celebrating? -->
                <div class="mb-12">
                    <div class="flex items-center justify-center gap-2 mb-8">
                        <h2 class="text-custom-dark text-lg font-bold text-center">
                            What moment are you celebrating?
                        </h2>
                        <div class="hint-container relative">
                            <img src="media/hint-grey.svg" alt="Hint" class="w-4 h-4 cursor-pointer">
                            <div class="tooltip absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 bg-custom-dark text-white text-xs rounded-lg px-3 py-2 whitespace-nowrap opacity-0 invisible transition-all duration-200 z-50">
                                Choose the special occasion or reason for this custom song
                            </div>
                        </div>
                    </div>
                    <div class="flex flex-wrap justify-center gap-3">
                        <button class="option-button px-4 py-2 rounded-full text-sm font-semibold" data-option="just-because">
                            Just Because ‚ú®
                        </button>
                        <button class="option-button px-4 py-2 rounded-full text-sm font-semibold" data-option="birthday">
                            Birthday üéÇ
                        </button>
                        <button class="option-button px-4 py-2 rounded-full text-sm font-semibold" data-option="love-story">
                            Our Love Story ü•∞
                        </button>
                        <button class="option-button px-4 py-2 rounded-full text-sm font-semibold" data-option="engagement">
                            Engagement üíç
                        </button>
                        <button class="option-button px-4 py-2 rounded-full text-sm font-semibold" data-option="wedding">
                            Wedding üíí
                        </button>
                        <button class="option-button px-4 py-2 rounded-full text-sm font-semibold" data-option="anniversary">
                            Anniversary ‚ù§Ô∏è
                        </button>
                        <button class="option-button px-4 py-2 rounded-full text-sm font-semibold" data-option="valentines">
                            Valentine's Day üåπ
                        </button>
                        <button class="option-button px-4 py-2 rounded-full text-sm font-semibold" data-option="christmas">
                            Christmas üéÑ
                        </button>
                        <button class="option-button px-4 py-2 rounded-full text-sm font-semibold" data-option="graduation">
                            Graduation üéì
                        </button>
                        <button class="option-button px-4 py-2 rounded-full text-sm font-semibold" data-option="mothers-day">
                            Mother's Day üë©
                        </button>
                        <button class="option-button px-4 py-2 rounded-full text-sm font-semibold" data-option="fathers-day">
                            Father's Day üë®
                        </button>
                        <button class="option-button px-4 py-2 rounded-full text-sm font-semibold" data-option="new-baby">
                            New Baby üê£
                        </button>
                        <button class="option-button px-4 py-2 rounded-full text-sm font-semibold" data-option="prank">
                            Prank ü§°
                        </button>
                        <button class="option-button px-4 py-2 rounded-full text-sm font-semibold" data-option="memorial">
                            Memorial üïØÔ∏è
                        </button>
                        <button class="option-button px-4 py-2 rounded-full text-sm font-semibold" data-option="other">
                            Other
                        </button>
                    </div>
                </div>

                <!-- Divider -->
                <div class="border-t border-gray-200 my-8"></div>

                <!-- Question 2: What vibe are you going for? -->
                <div class="mb-12">
                    <div class="flex items-center justify-center gap-2 mb-4">
                        <h2 class="text-custom-dark text-lg font-bold">
                            What vibe are you going for?
                        </h2>
                        <div class="hint-container relative">
                            <img src="media/hint-grey.svg" alt="Hint" class="w-4 h-4 cursor-pointer">
                            <div class="tooltip absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 bg-custom-dark text-white text-xs rounded-lg px-3 py-2 whitespace-nowrap opacity-0 invisible transition-all duration-200 z-50">
                                Select the emotional tone and mood for your song (choose up to 2)
                            </div>
                        </div>
                    </div>
                    <p class="text-custom-dark text-sm text-center mb-6">
                        Feel free to choose up to two
                    </p>
                    <div class="flex flex-wrap justify-center gap-3">
                        <button class="option-button px-4 py-2 rounded-full text-sm font-semibold" data-option="happy">
                            happy
                        </button>
                        <button class="option-button px-4 py-2 rounded-full text-sm font-semibold" data-option="lighthearted">
                            lighthearted
                        </button>
                        <button class="option-button px-4 py-2 rounded-full text-sm font-semibold" data-option="comical">
                            comical
                        </button>
                        <button class="option-button px-4 py-2 rounded-full text-sm font-semibold" data-option="heartfelt">
                            heartfelt
                        </button>
                        <button class="option-button px-4 py-2 rounded-full text-sm font-semibold" data-option="uplifting">
                            uplifting
                        </button>
                        <button class="option-button px-4 py-2 rounded-full text-sm font-semibold" data-option="romantic">
                            romantic
                        </button>
                        <button class="option-button px-4 py-2 rounded-full text-sm font-semibold" data-option="reflective">
                            reflective
                        </button>
                        <button class="option-button px-4 py-2 rounded-full text-sm font-semibold" data-option="somber">
                            somber
                        </button>
                    </div>
                </div>

                <!-- Divider -->
                <div class="border-t border-gray-200 my-8"></div>

                <!-- Question 3: What kind of artist do you want to work with? -->
                <div class="mb-12">
                    <div class="flex items-center justify-center gap-2 mb-8">
                        <h2 class="text-custom-dark text-lg font-bold">
                            What genre do you prefer ?
                        </h2>
                        <div class="hint-container relative">
                            <img src="media/hint-grey.svg" alt="Hint" class="w-4 h-4 cursor-pointer">
                            <div class="tooltip absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 bg-custom-dark text-white text-xs rounded-lg px-3 py-2 whitespace-nowrap opacity-0 invisible transition-all duration-200 z-50">
                                Choose the musical style and genre that fits your vision
                            </div>
                        </div>
                    </div>
                    <div class="flex flex-wrap justify-center gap-3">
                        <button class="option-button px-4 py-2 rounded-full text-sm font-semibold" data-option="rap-hiphop">
                            Rap / Hip-Hop
                        </button>
                        <button class="option-button px-4 py-2 rounded-full text-sm font-semibold" data-option="folk">
                            Folk
                        </button>
                        <button class="option-button px-4 py-2 rounded-full text-sm font-semibold" data-option="rock">
                            Rock
                        </button>
                        <button class="option-button px-4 py-2 rounded-full text-sm font-semibold" data-option="jazz">
                            Jazz
                        </button>
                        <button class="option-button px-4 py-2 rounded-full text-sm font-semibold" data-option="rnb">
                            R&B
                        </button>
                        <button class="option-button px-4 py-2 rounded-full text-sm font-semibold" data-option="country">
                            Country
                        </button>
                        <button class="option-button px-4 py-2 rounded-full text-sm font-semibold" data-option="singer-songwriter">
                            Singer Songwriter
                        </button>
                        <button class="option-button px-4 py-2 rounded-full text-sm font-semibold" data-option="acoustic-pop">
                            Acoustic Pop
                        </button>
                        <button class="option-button px-4 py-2 rounded-full text-sm font-semibold" data-option="electronic">
                            Electronic
                        </button>
                    </div>
                </div>

                <!-- Divider -->
                <div class="border-t border-gray-200 my-8"></div>

                <!-- Question 4: Male or female artist? -->
                <div class="mb-12">
                    <div class="flex items-center justify-center gap-2 mb-8">
                        <h2 class="text-custom-dark text-lg font-bold text-center">
                            Are you looking for a male or female vocals?
                        </h2>
                        <div class="hint-container relative">
                            <img src="media/hint-grey.svg" alt="Hint" class="w-4 h-4 cursor-pointer">
                            <div class="tooltip absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 bg-custom-dark text-white text-xs rounded-lg px-3 py-2 whitespace-nowrap opacity-0 invisible transition-all duration-200 z-50">
                                Select the vocal gender that best matches your song's style
                            </div>
                        </div>
                    </div>
                    <div class="flex justify-center gap-4">
                        <button class="option-button px-6 py-2 rounded-full text-sm font-semibold" data-option="male">
                            Male
                        </button>
                        <button class="option-button px-6 py-2 rounded-full text-sm font-semibold" data-option="female">
                            Female
                        </button>
                        <button class="option-button px-6 py-2 rounded-full text-sm font-semibold" data-option="no-preference">
                            No preference
                        </button>
                    </div>
                </div>

                <!-- Testimonial Section -->
                <div class="border border-gray-200 rounded-xl p-6 mb-8">
                    <div class="flex justify-center mb-4">
                        <div class="flex space-x-1">
                            <button class="review-indicator w-2 h-2 bg-gray-800 rounded-full transition-all duration-300 hover:scale-110 cursor-pointer" data-review="0"></button>
                            <button class="review-indicator w-2 h-2 bg-gray-300 rounded-full transition-all duration-300 hover:scale-110 cursor-pointer" data-review="1"></button>
                            <button class="review-indicator w-2 h-2 bg-gray-300 rounded-full transition-all duration-300 hover:scale-110 cursor-pointer" data-review="2"></button>
                        </div>
                    </div>
                    <div class="review-content relative overflow-hidden" style="height: 80px;">
                        <div class="review-slider flex transition-transform duration-500 ease-in-out" id="reviewSlider" style="width: 300%;">
                            <div class="review-slide w-1/3 flex-shrink-0 flex items-center justify-center">
                                <p class="text-custom-dark text-sm leading-relaxed text-center px-4">
                                    ‚ù§Ô∏è "Loved the song they made for my sister, it was so personal and sweet. She cried when she heard it ‚ù§Ô∏è."
                                </p>
                            </div>
                            <div class="review-slide w-1/3 flex-shrink-0 flex items-center justify-center">
                                <p class="text-custom-dark text-sm leading-relaxed text-center px-4">
                                    Honestly didn't expect it to be this good. Sent them a few details and got back a song my friend keeps replaying.
                                </p>
                            </div>
                            <div class="review-slide w-1/3 flex-shrink-0 flex items-center justify-center">
                                <p class="text-custom-dark text-sm leading-relaxed text-center px-4">
                                    Such a unique gift. I surprised my fianc√© with a song and he said it's the best present he's ever had.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <div class="fixed bottom-0 left-0 right-0 bg-custom-beige/60 backdrop-blur-sm shadow-lg">
        <div class="max-w-4xl mx-auto px-8 py-4">
            <div class="flex justify-center">
                <button id="nextBtn" class="next-button-inactive px-8 py-3 rounded-full font-medium transition-all duration-200 cursor-not-allowed">
                    Next
                </button>
            </div>
        </div>
    </div>

    <!-- Exit Confirmation Modal -->
    <div id="exitModal" class="fixed inset-0 modal-overlay z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="modal-content w-full max-w-md p-6">
                <!-- Modal Header -->
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-custom-gray text-lg font-bold tracking-tight">Progress will be lost</h3>
                    <button id="closeModalBtn" class="w-6 h-6">
                        <img src="media/close-button-small.svg" alt="Close" class="w-full h-full">
                    </button>
                </div>
                
                <!-- Modal Content -->
                <p class="text-custom-gray text-sm leading-relaxed mb-6">
                    If you leave this page, all your progress will be lost. Are you sure you want to continue?
                </p>
                
                <!-- Divider -->
                <div class="border-t border-gray-200 mb-6"></div>
                
                <!-- Modal Actions -->
                <div class="flex gap-4">
                    <button id="cancelExitBtn" class="flex-1 bg-custom-gray/12 text-custom-dark px-6 py-3 rounded-full font-medium hover:bg-custom-gray/20 transition-colors">
                        Cancel
                    </button>
                    <button id="confirmExitBtn" class="flex-1 bg-custom-gray text-white px-6 py-3 rounded-full font-medium hover:bg-custom-gray/90 transition-colors">
                        Leave
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Mobile menu functionality
        const burgerMenu = document.getElementById('burgerMenu');
        const mobileMenu = document.getElementById('mobileMenu');
        
        if (burgerMenu && mobileMenu) {
            burgerMenu.addEventListener('click', function() {
                this.classList.toggle('open');
                mobileMenu.classList.toggle('open');
            });
            
            // Close mobile menu when clicking on a link
            mobileMenu.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    this.classList.remove('open');
                    burgerMenu.classList.remove('open');
                }
            });
            
            // Close mobile menu when clicking outside
            document.addEventListener('click', function(e) {
                if (!burgerMenu.contains(e.target) && !mobileMenu.contains(e.target)) {
                    mobileMenu.classList.remove('open');
                    burgerMenu.classList.remove('open');
                }
            });
        }

        // Option selection functionality
        let selectedOptions = {
            moment: null,
            vibe: [],
            genre: null,
            gender: null
        };

        function setupFormListeners() {
            document.querySelectorAll('.option-button').forEach(button => {
                button.addEventListener('click', function() {
                    const option = this.dataset.option;
                    const question = this.closest('.mb-12');
                    
                    // Determine which question this button belongs to
                    const questionText = question.querySelector('h2').textContent.toLowerCase();
                    
                    if (questionText.includes('moment') && questionText.includes('celebrating')) {
                        // Single selection for moment
                        document.querySelectorAll('[data-option]').forEach(btn => {
                            if (btn.closest('.mb-12') === question) {
                                btn.classList.remove('selected');
                            }
                        });
                        this.classList.add('selected');
                        selectedOptions.moment = option;
                    } else if (questionText.includes('vibe')) {
                        // Multiple selection for vibe (up to 2)
                        if (this.classList.contains('selected')) {
                            this.classList.remove('selected');
                            selectedOptions.vibe = selectedOptions.vibe.filter(v => v !== option);
                        } else if (selectedOptions.vibe.length < 2) {
                            this.classList.add('selected');
                            selectedOptions.vibe.push(option);
                        }
                    } else if (questionText.includes('genre') && questionText.includes('prefer')) {
                        // Single selection for genre
                        document.querySelectorAll('[data-option]').forEach(btn => {
                            if (btn.closest('.mb-12') === question) {
                                btn.classList.remove('selected');
                            }
                        });
                        this.classList.add('selected');
                        selectedOptions.genre = option;
                    } else if (questionText.includes('male or female') && questionText.includes('vocals')) {
                        // Single selection for gender
                        document.querySelectorAll('[data-option]').forEach(btn => {
                            if (btn.closest('.mb-12') === question) {
                                btn.classList.remove('selected');
                            }
                        });
                        this.classList.add('selected');
                        selectedOptions.gender = option;
                    }
                    
                    updateNextButton();
                });
            });
            
            // Next button functionality
            document.getElementById('nextBtn').addEventListener('click', function() {
                if (!this.disabled) {
                    // Store the selected options in localStorage for the next step
                    localStorage.setItem('songPreferences', JSON.stringify(selectedOptions));
                    // Navigate to step 2
                    window.location.href = 'create-song-step2.html';
                }
            });
        }

        function updateNextButton() {
            const nextBtn = document.getElementById('nextBtn');
            const isComplete = selectedOptions.moment && selectedOptions.genre && selectedOptions.gender;
            
            if (isComplete) {
                nextBtn.className = 'next-button-active px-8 py-3 rounded-full font-medium transition-all duration-200 cursor-pointer';
                nextBtn.disabled = false;
            } else {
                nextBtn.className = 'next-button-inactive px-8 py-3 rounded-full font-medium transition-all duration-200 cursor-not-allowed';
                nextBtn.disabled = true;
            }
        }


        // Exit modal functionality
        const exitModal = document.getElementById('exitModal');
        const closeBtn = document.getElementById('closeBtn');
        const closeModalBtn = document.getElementById('closeModalBtn');
        const cancelExitBtn = document.getElementById('cancelExitBtn');
        const confirmExitBtn = document.getElementById('confirmExitBtn');

        // Show modal when close button is clicked
        closeBtn.addEventListener('click', function() {
            exitModal.classList.remove('hidden');
        });

        // Close modal when X button is clicked
        closeModalBtn.addEventListener('click', function() {
            exitModal.classList.add('hidden');
        });

        // Cancel exit
        cancelExitBtn.addEventListener('click', function() {
            exitModal.classList.add('hidden');
        });

        // Confirm exit - go back to home
        confirmExitBtn.addEventListener('click', function() {
            // Clear localStorage to reset progress
            localStorage.removeItem('songPreferences');
            localStorage.removeItem('songFormData');
            localStorage.removeItem('contactData');
            // Navigate to home page
            window.location.href = 'index.html';
        });

        // Function to clear all form data
        function clearAllFormData() {
            localStorage.removeItem('songPreferences');
            localStorage.removeItem('songFormData');
            localStorage.removeItem('contactData');
        }

        // Clear form data when clicking logo or navigation links to home
        document.querySelectorAll('a[href="index.html"]').forEach(link => {
            link.addEventListener('click', function(e) {
                clearAllFormData();
            });
        });

        // Close modal when clicking outside
        exitModal.addEventListener('click', function(e) {
            if (e.target === exitModal) {
                exitModal.classList.add('hidden');
            }
        });

        // Load saved data when page loads
        function loadSavedData() {
            const savedPreferences = localStorage.getItem('songPreferences');
            if (savedPreferences) {
                const preferences = JSON.parse(savedPreferences);
                console.log('Loaded preferences:', preferences);
                
                // Restore selections
                if (preferences.moment) {
                    const momentBtn = document.querySelector(`[data-option="${preferences.moment}"]`);
                    if (momentBtn) {
                        momentBtn.classList.add('selected');
                    }
                }
                
                if (preferences.vibe && preferences.vibe.length > 0) {
                    preferences.vibe.forEach(vibe => {
                        const vibeBtn = document.querySelector(`[data-option="${vibe}"]`);
                        if (vibeBtn) {
                            vibeBtn.classList.add('selected');
                        }
                    });
                }
                
                if (preferences.genre) {
                    const genreBtn = document.querySelector(`[data-option="${preferences.genre}"]`);
                    if (genreBtn) {
                        genreBtn.classList.add('selected');
                    }
                }
                
                if (preferences.gender) {
                    const genderBtn = document.querySelector(`[data-option="${preferences.gender}"]`);
                    if (genderBtn) {
                        genderBtn.classList.add('selected');
                    }
                }
                
                // Update selectedOptions object
                selectedOptions = preferences;
            }
        }

        // Review carousel functionality
        let currentReviewIndex = 0;
        let reviewSlider, indicators;
        let autoRotateInterval;
        
        function initCarousel() {
            reviewSlider = document.getElementById('reviewSlider');
            indicators = document.querySelectorAll('.review-indicator');
            
            if (!reviewSlider || !indicators.length) {
                setTimeout(initCarousel, 100);
                return;
            }
            
            console.log('Carousel initialized!');
            
            // Set initial position (show first review)
            updateCarousel();
            
            // Add click handlers for indicators
            indicators.forEach((indicator, index) => {
                indicator.addEventListener('click', function() {
                    goToReview(index);
                });
            });
            
            // Start auto-rotation
            startAutoRotation();
        }
        
        function updateCarousel() {
            if (!reviewSlider || !indicators.length) return;
            
            // Move slider to show current review
            const translateX = -currentReviewIndex * 33.333; // 33.333% per slide
            reviewSlider.style.transform = `translateX(${translateX}%)`;
            
            // Update indicators
            indicators.forEach((indicator, index) => {
                if (index === currentReviewIndex) {
                    indicator.classList.remove('bg-gray-300');
                    indicator.classList.add('bg-gray-800');
                    indicator.style.transform = 'scale(1.2)';
                } else {
                    indicator.classList.remove('bg-gray-800');
                    indicator.classList.add('bg-gray-300');
                    indicator.style.transform = 'scale(1)';
                }
            });
        }
        
        function goToReview(index) {
            currentReviewIndex = index;
            updateCarousel();
            
            // Restart auto-rotation after manual click
            startAutoRotation();
        }
        
        function nextReview() {
            currentReviewIndex = (currentReviewIndex + 1) % 3;
            updateCarousel();
        }
        
        function startAutoRotation() {
            // Clear existing interval
            if (autoRotateInterval) {
                clearInterval(autoRotateInterval);
            }
            
            // Start new interval
            autoRotateInterval = setInterval(function() {
                nextReview();
            }, 5000);
        }

        // Initialize everything after DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, initializing...');
            
            // Initialize form functionality
            setupFormListeners();
            loadSavedData();
            updateNextButton();
            
            // Initialize carousel
            initCarousel();
        });
    </script>
</body>
</html>
